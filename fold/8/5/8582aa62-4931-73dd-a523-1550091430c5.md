---
id: 8582aa62-4931-73dd-a523-1550091430c5
title: webhook_integration.rs
author: system
file_path: tests/webhook_integration.rs
language: rust
memory_type: codebase
created_at: 2026-02-03T08:07:27.899079500Z
updated_at: 2026-02-03T08:07:27.899079500Z
---

//! Integration tests for webhook handling.
//!
//! Tests GitHub and GitLab webhook processing, signature verification,
//! event parsing, and database updates.

use fold::{db, Result};
use hmac::{Hmac, Mac};
use serde_json::json;
use sha2::Sha256;

type HmacSha256 = Hmac<Sha256>;

// ============================================================================
// Test Setup Helpers
// ============================================================================

/// Initialize test database with migrations.
async fn setup_test_db() -> db::DbPool {
    let pool = db::init_pool(":memory:").await.unwrap();
    db::migrate(&pool).await.unwrap();
    pool
}

/// Create a test project in the database.
async fn create_test_project(pool: &db::DbPool, id: &str) {
    db::create_project(
        pool,
        db::CreateProject {
            id: id.to_string(),
            name: "Test Project".to_string(),
            slug: "test-project".to_string(),
            des