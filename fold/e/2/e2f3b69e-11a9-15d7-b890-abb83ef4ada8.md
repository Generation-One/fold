---
id: e2f3b69e-11a9-15d7-b890-abb83ef4ada8
title: mcp_integration.rs
author: system
file_path: tests/mcp_integration.rs
language: rust
memory_type: codebase
created_at: 2026-02-03T08:07:19.671407Z
updated_at: 2026-02-03T08:07:19.671407Z
---

//! MCP Integration Tests for Fold Server
//!
//! Tests the MCP (Model Context Protocol) JSON-RPC endpoint implementation.
//! These tests verify:
//! - JSON-RPC 2.0 protocol compliance
//! - All 11 MCP tools work correctly
//! - Error handling for invalid requests
//! - Response format matches MCP spec

#[allow(dead_code)]
mod common;

#[allow(unused_imports)]
use axum::body::Body;
#[allow(unused_imports)]
use axum::http::{Request, StatusCode};
#[allow(unused_imports)]
use axum::Router;
use serde_json::{json, Value};
use sha2::{Digest, Sha256};
#[allow(unused_imports)]
use tower::ServiceExt;

use fold::db::{self, DbPool};
use fold::Result;

// ============================================================================
// Test Helpers
// ============================================================================

/// Create a test database with migrations and seed data.
async fn setup_test_db() -> Result<DbPool> {
    let pool = db::init_pool(":memory: