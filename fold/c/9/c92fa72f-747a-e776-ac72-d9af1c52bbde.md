---
id: c92fa72f-747a-e776-ac72-d9af1c52bbde
title: integration_tests.rs
author: system
file_path: tests/integration_tests.rs
language: rust
memory_type: codebase
created_at: 2026-02-03T08:07:17.753650700Z
updated_at: 2026-02-03T08:07:17.753650700Z
---

//! Integration tests for Fold server.
//!
//! Tests database operations and embedding service.

use fold::db;
use fold::Result;

// ============================================================================
// Database Integration Tests
// ============================================================================

/// Test basic database initialization and migration
#[tokio::test]
async fn test_database_init_and_migrate() -> Result<()> {
    let pool = db::init_pool(":memory:").await?;
    db::migrate(&pool).await?;

    // Verify tables exist by querying them
    let result: (i64,) = sqlx::query_as("SELECT COUNT(*) FROM projects")
        .fetch_one(&pool)
        .await?;
    assert_eq!(result.0, 0);

    let result: (i64,) = sqlx::query_as("SELECT COUNT(*) FROM memories")
        .fetch_one(&pool)
        .await?;
    assert_eq!(result.0, 0);

    let result: (i64,) = sqlx::query_as("SELECT COUNT(*) FROM repositories")
        .fetch_one(&pool)
   