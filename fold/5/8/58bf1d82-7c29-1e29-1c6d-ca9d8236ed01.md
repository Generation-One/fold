---
id: 58bf1d82-7c29-1e29-1c6d-ca9d8236ed01
title: attachments.rs
author: system
file_path: src/db/attachments.rs
language: rust
memory_type: codebase
created_at: 2026-02-03T08:05:15.275202100Z
updated_at: 2026-02-03T08:05:15.275202100Z
---

//! Attachment database queries.
//!
//! Attachments are files associated with memories (images, PDFs, etc.).

use crate::{Error, Result};
use serde::{Deserialize, Serialize};
use sqlx::FromRow;

use super::DbPool;

// ============================================================================
// Types
// ============================================================================

/// Attachment record from the database.
#[derive(Debug, Clone, FromRow, Serialize, Deserialize)]
pub struct Attachment {
    pub id: String,
    pub memory_id: String,
    pub filename: String,
    pub content_type: String,
    pub size_bytes: i64,
    pub storage_path: String,
    pub created_at: String,
}

impl Attachment {
    /// Get file extension from filename.
    pub fn extension(&self) -> Option<&str> {
        self.filename.rsplit('.').next()
    }

    /// Check if attachment is an image.
    pub fn is_image(&self) -> bool {
        self.content_type.starts_with