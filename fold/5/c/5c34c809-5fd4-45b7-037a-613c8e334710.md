---
id: 5c34c809-5fd4-45b7-037a-613c8e334710
title: indexer.rs
author: system
file_path: src/services/indexer.rs
language: rust
memory_type: codebase
created_at: 2026-02-03T08:06:45.857358400Z
updated_at: 2026-02-03T08:06:45.857358400Z
---

//! Indexer service for codebase indexing.
//!
//! Scans project directories, detects languages, and indexes source files
//! with LLM-generated summaries. Summaries are written to fold/a/b/hash.md
//! using hash-based storage for deduplication.

use std::collections::HashMap;
use std::path::{Path, PathBuf};
use std::sync::Arc;

use chrono::Utc;
use sha2::{Sha256, Digest};
use tokio::fs;
use tracing::{debug, info, warn};

use crate::error::{Error, Result};
use crate::models::{Memory, MemoryCreate, MemoryType, Project};

use super::{FoldStorageService, GitService, LlmService, MemoryService};

/// Maximum file size to index (100KB)
const MAX_FILE_SIZE: usize = 100_000;

/// Language detection by extension
const LANGUAGE_MAP: &[(&str, &str)] = &[
    (".py", "python"),
    (".js", "javascript"),
    (".ts", "typescript"),
    (".tsx", "typescript"),
    (".jsx", "javascript"),
    (".java", "java"),
    (".go", "go"),
    (".rs", "rust"),
    (".rb", "ruby