---
id: fba9e26f-10ca-1b06-520e-cf40797df476
title: mod.rs
author: system
file_path: src/api/mod.rs
language: rust
memory_type: codebase
created_at: 2026-02-03T08:05:01.170015Z
updated_at: 2026-02-03T08:05:01.170015Z
---

//! API Routes for Fold
//!
//! This module combines all API routes into a single router.
//! Routes are organized by domain and apply appropriate middleware.

mod auth;
pub mod mcp;
mod memories;
mod projects;
mod providers;
mod repositories;
mod search;
pub mod status;
mod webhooks;

use axum::Router;

use crate::middleware::require_token;
use crate::AppState;

/// Build the complete API router.
///
/// Route structure:
/// - /auth/* - Authentication (public + session-protected)
/// - /projects/* - Project management (token-protected)
/// - /providers/* - Provider management (session-protected, admin)
/// - /mcp - MCP JSON-RPC endpoint (token-protected)
/// - /webhooks/* - Git webhooks (signature-verified)
/// - /health, /status, /metrics - Health checks (public)
pub fn routes(state: AppState) -> Router<AppState> {
    Router::new()
        // Health and status endpoints (public)
        .merge(status::routes())
        // Authentication routes (mixed