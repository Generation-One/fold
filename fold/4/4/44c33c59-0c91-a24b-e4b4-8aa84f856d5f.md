---
id: 44c33c59-0c91-a24b-e4b4-8aa84f856d5f
title: mod.rs
author: system
file_path: tests/common/mod.rs
language: rust
memory_type: codebase
created_at: 2026-02-03T08:07:10.533773600Z
updated_at: 2026-02-03T08:07:10.533773600Z
---

//! Common test utilities and helpers.

use axum::body::Body;
use axum::http::{Request, Response};
use fold::AppState;
use serde_json::Value;
use tower::ServiceExt;

/// Extract JSON body from response
pub async fn extract_json(response: Response<Body>) -> Value {
    let bytes = axum::body::to_bytes(response.into_body(), usize::MAX)
        .await
        .expect("Failed to read body");
    serde_json::from_slice(&bytes).unwrap_or(Value::Null)
}

/// Create a GET request
pub fn get_request(uri: &str, token: &str) -> Request<Body> {
    Request::builder()
        .uri(uri)
        .header("Authorization", format!("Bearer {}", token))
        .body(Body::empty())
        .unwrap()
}

/// Create a POST request with JSON body
pub fn post_json(uri: &str, token: &str, body: Value) -> Request<Body> {
    Request::builder()
        .method("POST")
        .uri(uri)
        .header("Content-Type", "application/json")
        .header("Authorization", format!("Bear