---
id: 16d9f830-efc9-fb3c-dd89-df228b7e94e6
title: auth.rs
author: system
file_path: src/api/auth.rs
language: rust
memory_type: codebase
created_at: 2026-02-03T08:04:55.013821900Z
updated_at: 2026-02-03T08:04:55.013821900Z
---

//! Authentication Routes
//!
//! Handles OAuth2/OIDC authentication flows with support for multiple providers.
//!
//! Routes:
//! - GET /auth/providers - List available auth providers
//! - GET /auth/login/:provider - Redirect to provider login
//! - GET /auth/callback/:provider - Handle OAuth callback
//! - POST /auth/logout - End session
//! - GET /auth/me - Get current user info
//! - POST /auth/bootstrap - Create initial admin user with bootstrap token
//! - GET /auth/tokens - List user's API tokens
//! - POST /auth/tokens - Create new API token
//! - DELETE /auth/tokens/:id - Revoke an API token

use axum::{
    extract::{Path, Query, State, Extension},
    middleware,
    response::{IntoResponse, Redirect, Response},
    routing::{get, post, delete},
    Json, Router,
};
use serde::{Deserialize, Serialize};
use sha2::{Digest, Sha256};
use axum_extra::extract::CookieJar;
use axum_extra::extract::cookie::{Cookie, SameSite};
use chrono::Utc;
use time;
