---
id: 6f685121-7e9b-3a69-7698-869bafd53dc8
title: Authentication Middleware for Session and Token-Based Access
author: system
tags:
- middleware
- auth
- async
- http
- user-management
- validation
file_path: src/middleware/mod.rs
language: rust
memory_type: codebase
created_at: 2026-02-03T08:36:43.927214500Z
updated_at: 2026-02-03T08:36:43.927214500Z
---

This file implements a unified authentication middleware system for the Fold application that supports both session-based authentication (for web UI) and token-based authentication (for API/programmatic access). It provides the `require_auth` middleware function that attempts session validation first, then falls back to token validation, and injects an `AuthUser` context into request extensions for downstream handlers. The module also exports helper types and functions for managing authenticated user context across different authentication methods.