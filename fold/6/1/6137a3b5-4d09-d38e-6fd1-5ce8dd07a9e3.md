---
id: 6137a3b5-4d09-d38e-6fd1-5ce8dd07a9e3
title: git_sync.rs
author: system
file_path: src/services/git_sync.rs
language: rust
memory_type: codebase
created_at: 2026-02-03T08:06:40.540314500Z
updated_at: 2026-02-03T08:06:40.540314500Z
---

//! Git sync service for webhook processing.
//!
//! Handles incoming webhooks from GitHub and GitLab,
//! processes commits, and creates memory summaries.

use std::sync::Arc;

use chrono::Utc;
use serde::{Deserialize, Serialize};
use tracing::{debug, info, warn};

use crate::db::DbPool;
use crate::error::{Error, Result};
use crate::models::{
    CommitInfo, GitCommit, Memory, MemoryCreate, MemoryLink, MemoryType, Project, Repository,
};

use super::{
    GitHubService, GitLabService, IndexerService, LlmService, MemoryService,
};

/// Service for processing git webhooks and syncing repositories.
#[derive(Clone)]
pub struct GitSyncService {
    db: DbPool,
    github: Arc<GitHubService>,
    gitlab: Arc<GitLabService>,
    memory: MemoryService,
    llm: Arc<LlmService>,
    indexer: IndexerService,
}

/// Webhook payload from GitHub
#[derive(Debug, Clone, Deserialize)]
pub struct GitHubPushPayload {
    #[serde(rename = "ref")]
    pub ref_name: Str