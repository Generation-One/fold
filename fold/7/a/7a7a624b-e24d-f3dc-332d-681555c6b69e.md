---
id: 7a7a624b-e24d-f3dc-332d-681555c6b69e
title: Multi-provider embedding service with fallback and retry logic
author: system
tags:
- service
- async
- database
- http
- auth
- api
file_path: src/services/embeddings.rs
language: rust
memory_type: codebase
created_at: 2026-02-03T08:40:42.119012300Z
updated_at: 2026-02-03T08:40:42.119012300Z
---

This file implements an embedding service that supports multiple providers (Gemini and OpenAI) with automatic fallback mechanisms when rate limits or failures occur. It manages runtime provider configurations loaded from a database with environment variable seeding, handles batch processing of texts with configurable retry logic, and provides hash-based placeholder embeddings as a final fallback. The service uses async/await patterns with tokio for concurrent operations and maintains provider state through a thread-safe RwLock.