---
id: 030456bd-3358-20ca-9b17-ba403c59f217
title: git_local.rs
author: system
file_path: src/services/git_local.rs
language: rust
memory_type: codebase
created_at: 2026-02-03T08:06:38.907284600Z
updated_at: 2026-02-03T08:06:38.907284600Z
---

//! Local git operations service.
//!
//! Handles cloning and pulling repositories locally for efficient indexing.
//! Uses git2 library for native git operations.

use std::path::{Path, PathBuf};

use git2::{Cred, FetchOptions, RemoteCallbacks, Repository as GitRepo};
use tracing::{debug, info, warn};

use crate::error::{Error, Result};

/// Default base directory for cloned repositories
const DEFAULT_REPOS_DIR: &str = "data/repos";

/// Service for local git operations.
#[derive(Clone)]
pub struct GitLocalService {
    /// Base directory for cloned repositories
    base_dir: PathBuf,
}

impl GitLocalService {
    /// Create a new git local service with the default repos directory.
    pub fn new() -> Self {
        Self {
            base_dir: PathBuf::from(DEFAULT_REPOS_DIR),
        }
    }

    /// Create a new git local service with a custom base directory.
    pub fn with_base_dir(base_dir: impl Into<PathBuf>) -> Self {
        Self {
           